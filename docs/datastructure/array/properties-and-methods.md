# 数组的属性和方法

## 1. length 属性

数组的项数保存在其 `length` 属性中，这个属性始终返回 `0` 或更大的值。

数组的 `length` 属性不是只读的，可以通过这个属性，从数组的末尾移除项或向数组中添加新项。

```javascript
var colors = ["red", "blue", "green"];
colors.length = 2;
alert(colors[2]); // undefined
```

将数组设置为 `2` 就移除最后一项，最后一项的值就变成了 `undefined`

如果设置的 `length` 属性大于数组项数的值，则新增的每一项都会取得 `undefined` 值

利用 `length` 属性的动态改变，也可以方便地在数组末尾添加新项

```javascript
var colors = ["red", "blue", "green"];
colors[colors.length] = "black"; // 末尾添加一个元素
colors[colors.length] = "brown"; // 末尾再添加一个元素
```

当把一个值放在超出当前数组大小的位置上时，数组会重新计算其 `length` 属性，其值等于最后一项的索引加 `1`

数组最多包含 4 294 967 295 项，超出会发生异常，创建初始大小接近上限的数组，可能会导致运行时间超长的脚本错误。

## 2. 检测数组

### 2.1 instanceof

对于一个网页或者一个全局作用域而言，使用 `instanceof` 操作符

```javascript
if (value instanceof Array) {
  ...
}
```

`instanceof` 操作符的问题在于，它假定只有一个全局执行环境。如果网页中有多个框架，，那实际上就存在两个以上不同的全局执行环境，从而存在两个以上不同版本的 `Array` 构造函数。从一个框架出传入另一个框架的数组，与第二个框架原生的数组具有不同的构造函数。

### 2.2 Array.isArray\(\)

`Array.isArray()` 方法，确定某个值是不是数组，不管是在哪个全局执行环境创建的

```javascript
if (Array.isArray(value)) {
  ...
}
```

## 3. 转换方法

### 3.1 三种转换

`toLocaleString()`、`toString()`、`valueOf()`

`toString()` 方法会返回由数组中每个值的字符串形式拼接而成的一个以逗号分隔的字符串，会调用每一项的 `toString()` 方法

`valueOf()` 方法返回的是数组中的值，与 `toString()` 方法结果相同

`toLocaleString()` 方法与前面两个返回的值一样，但是调用的是每一项的 `toLocaleString()` 方法

> 注意：当数组中包含对象时，该项返回的是 `[object Object]`，而不会显示这个对象

### 3.2 `join()` 转换成字符串

* 提供以不同的分隔符来把这个数组构建成字符串
* 传入参数为一个字符串，以这个字符串分隔数组的每一项
* 不传入参数或传入 `undefined`，则默认使用逗号隔开

## 4. 栈方法

ECMAScript 提供了让数组的行为向栈一样的方法：`push()` 和 `pop()`

### 4.1 push\(\) 推入

接受**任意**数量的参数，把它们逐个添加到数组末尾，并**返回修改后数组长度**

### 4.1 pop\(\) 弹出

从数组末尾移除最后一项，`length` 减 `1`，并返回该项

## 5. 队列方法

模拟队列数据结构的方法： `shift()` 和 `unshift()`

### 5.1 shift\(\) 移除

能够移除数组中的第一个项，`length` 减 `1`，并返回该项

与 `push()` 方法组合来模拟队列

### 5.2 unshift\(\) 添加

在数组前端添加**任意**个项，并**返回数组长度**

与 `pop()` 方法结合可以反向模拟队列

## 6. 重排序方法

### 6.1 reverse\(\) 反转

反转数组项的顺序

### 6.2 sort\(\) 自定义排序

会调用数组每一项的 `toString()` 方法，得到字符串，然后确定如何排序，注意，是对字符串进行排序，而不是数值，所以没法达到预期效果

`sort()` 方法可以接受一个比较函数，以便我们指定排序方法。 比较函数接受两个参数：

* 如果第一个参数应该位于第二个之前则返回一个负数
* 如果两个参数相等则返回 0
* 如果第一个参数应该位于第二个之后则返回一个正数

```javascript
function compare(value1, value2) {
  if (value1 < value2) {
    return -1;
  }
  else if (value1 > value 2) {
    return 1;
  }
  else {
    return 0;
  }
}

var value = [5, 10, 1, 15];
value.sort(compare);
alert(value); // [1, 5, 10, 15]
```

上面是升序排列，降序排列只需要交换比较函数的返回值即可。

对于数值类型或者其 `valueOf()` 方法返回数值类型的对象，可以使用更简单的比较函数：

```javascript
function compare(value1, value2) {
  return value2 - value 1;
}
```

## 7. 操作方法

### 7.1 concat\(\) 连接

基于当前数组的所有项创建一个新数组。

先创建当前数组的一个副本，然后将接受到的参数添加到副本的末尾，最后返回新构建的数组。

* 没有传递参数，则只是复制当前数组并返回副本
* 传递的不是数值，简单地添加到结果数组的末尾，并返回
* 传递的是一个或多个数组，会将数组的每一项都添加到结果数组中

```javascript
var colors = ["red", "green", "blue"];
var colors2 = colors.concat("yellow", ["black", "brown"]);
alert(colors2); //red, green, blue, yellow, black, brown
```

### 7.2 slice\(\) 抽取

基于当前数组的一个或多个项创建一个新数组。

```javascript
slice(start, [end]);
```

* 一个参数，返回从该参数指定位置开始到当前数组末尾的所有项
* 两个参数，返回起始和结束位置之间的项，**不包括结束位置的项**
* 不会影响原始数组，返回新数组
* 参数中有负数，则是从后面开始算起
* 第一个参数数要比第二个小，否则返回空数组

### 7.3 splice\(\) 添加或删除

```javascript
splice(index, howmany, [item1, item2,...]);
```

**删除**

* 可以删除任意数量的项
* 指定两个参数，要删除的第一项位置和删除的项数

**插入**

* 可以向指定位置插入任意数量的项
* 提供三个以上参数，起始位置、0（要删除的项数）和要插入的项

**替换**

* 可以向指定位置插入任意数量的项，同时删除任意数量的项
* 指定三个以上参数，起始位置、要删除的项和要插入的任意数量的项

## 8. 位置方法

### 8.1 indexOf\(\) 特定值的位置

从数组开头开始查找

```javascript
indexOf(searchValue, [fromIndex]);
```

* 两个参数，第一个是查找的值，第二个可选，表示开始查找的位置
* 在比较第一个参数和数组中的每一项时，使用的是全等操作符，必须严格相等

### 8.2 lastIndexOf\(\) 特定值的位置

从数组末尾开始查找，但是返回的位置还是从开头算起的位置

```javascript
lastIndexOf(searchValue, [fromIndex]);
```

* 两个参数，第一个是查找的值，第二个可选，表示开始查找的位置
* 在比较第一个参数和数组中的每一项时，使用的是全等操作符，必须严格相等

## 9. 迭代方法

每个方法都接受两个参数：

* 在每一项上运行的函数
* 可选的，运行在该函数的作用域对象——影响 `this` 的值
* 运行函数接受的参数：数组项的值 `item`、该项在数组中的位置 `index`、数组对象本身 `array`

### 9.1 every\(\) 是否所有都符合

对数组中的每一项运行给定函数，如果该函数对每一项都返回 `true`，则返回 `true`

### 9.2 filter\(\) 过滤掉不符合的

对数组中的每一项运行给定函数，返回运行函数时返回 true 的项组成的数组

### 9.3 forEach\(\) 遍历

对数组中的每一项运行给定函数，无返回值，单纯的遍历

### 9.4 map\(\) 运行结果组成的数组

对数组中的每一项运行给定函数，返回每次函数调用的结果组成的数组

### 9.5 some\(\) 是否有符合的

对数组中的每一项运行给定函数，如果该函数对任一项返回 `true`，则返回 `true`

## 10. 归并方法

迭代所有项，然后构建一个最终返回值

接受两个参数

* 在每一项上调用的函数
* 可选的，作为归并基础的初始值
* 调用的函数接受的参数，前一个项的函数返回的值 `prev`、当前项的值 `cur`、项的索引 `index`、数组对象 `array`

### 10.1 reduce\(\)

从第一项开始遍历

```javascript
var values = [1, 2, 3, 4, 5];
var sum = values.reduce(function(prev, cur, index, array) {
  return prev + cur;
});
alert(sum); //15
```

### 10.2 reduceRight\(\)

从最后一项开始遍历，与 `reduce()` 方法类似

